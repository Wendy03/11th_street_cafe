import{c as g}from"./cartStore-f2274322.js";import{m as T,f as y,z as E,_ as $,o as c,c as m,a as e,F as O,s as P,x as C,t as d,l as w,v as k,R as F,r as n,b as r,w as V,u as f,d as L,q as S}from"./index-cdfc31b9.js";import{T as x}from"./Toast-8cca48e2.js";import{s as U}from"./statusStore-29c8f5f8.js";const D={data(){return{}},methods:{...T(g,["getCarts","addCouponCode"])},computed:{...y(g,["cart"]),...E(g,["coupon_code"])},mounted(){this.getCarts()}},I={class:"col-lg-4"},A={class:"border p-4 mb-4 bg-light"},N={class:"w-100"},q={class:"d-flex justify-content-between"},R={class:"mb-0 fw-bold"},j={class:"mb-0"},z={class:"mb-0 fw-bold"},B={class:"table mt-4 border-top border-bottom text-muted"},M=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),H={class:"text-end border-0 px-0 pt-4"},W=e("tr",null,[e("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 付款方式 "),e("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),G={class:"input-group mb-3 input-group-sm"},J={class:"input-group-append"},K={class:"d-flex justify-content-between mt-4"},Q=e("p",{class:"mb-0 h4 fw-bold"},"總計",-1),X={class:"mb-0 h4 fw-bold"};function Y(o,s,u,p,l,b){return c(),m("div",I,[e("div",A,[(c(!0),m(O,null,P(o.cart.carts,t=>(c(),m("div",{key:t.id,class:"d-flex mb-2"},[e("div",{style:C([{width:"55px","max-height":"48px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${t.product.imageUrl})`}]),class:"rounded-0 me-3"},null,4),e("div",N,[e("div",q,[e("p",R,d(t.product.title),1),e("p",j,"NT$ "+d(t.product.price),1)]),e("p",z,"x "+d(t.qty),1)])]))),128)),e("table",B,[e("tbody",null,[e("tr",null,[M,e("td",H,"NT$"+d(o.cart.total),1)]),W])]),e("div",G,[w(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=t=>o.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[k,o.coupon_code]]),e("div",J,[e("button",{class:"btn btn-outline-primary",type:"button",onClick:s[1]||(s[1]=t=>o.addCouponCode(o.coupon_code))}," 套用優惠碼 ")])]),e("div",K,[Q,e("p",X,"NT$"+d(o.cart.final_total),1)])])])}const Z=$(D,[["render",Y]]),{VITE_API:ee,VITE_PATH:se}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"coffee11",BASE_URL:"/11th_street_cafe/",MODE:"production",DEV:!1,PROD:!0},te={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""},isProcessing:!1}},components:{RouterLink:F},methods:{createOrder(){this.isProcessing=!0;const o=this.form;this.$http.post(`${ee}/api/${se}/order`,{data:o}).then(s=>{const{message:u,orderId:p}=s.data;this.isProcessing=!1,this.$refs.form.resetForm(),x.fire({title:`${u}`,icon:"success"}),this.$router.push(`/checkout/${p}`)}).catch(()=>{this.isProcessing=!1,x.fire({title:"無法新增資料，稍後再試",icon:"error"})})}}},oe={class:"col-lg-6"},le=e("h3",{class:"mb-3"},"客戶資訊",-1),re={class:"mb-3"},ae=e("label",{for:"email",class:"form-label"},"Email",-1),ne={class:"mb-3"},ie=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),de={class:"mb-3"},ce=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),me={class:"mb-3"},ue=e("label",{for:"address",class:"form-label"},"收件人地址",-1),pe={class:"mb-3"},_e=e("label",{for:"message",class:"form-label"},"留言",-1),fe={class:"d-flex mt-4 justify-content-between align-items-md-center align-items-end w-100"},be=e("i",{class:"bi bi-caret-left-fill me-2"},null,-1),he={class:"text-end"},ve=["disabled"];function ge(o,s,u,p,l,b){const t=n("VField"),i=n("ErrorMessage"),h=n("RouterLink"),v=n("VForm");return c(),m("div",oe,[le,r(v,{ref:"form",onSubmit:b.createOrder},{default:V(({errors:_})=>[e("div",re,[ae,r(t,{id:"email",name:"email",type:"email",class:f(["form-control",{"is-invalid":_.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[0]||(s[0]=a=>l.form.user.email=a)},null,8,["class","modelValue"]),r(i,{name:"email",class:"invalid-feedback"})]),e("div",ne,[ie,r(t,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":_.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[1]||(s[1]=a=>l.form.user.name=a)},null,8,["class","modelValue"]),r(i,{name:"姓名",class:"invalid-feedback"})]),e("div",de,[ce,r(t,{id:"tel",name:"電話",type:"tel",class:f(["form-control",{"is-invalid":_.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10|numeric",modelValue:l.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=a=>l.form.user.tel=a)},null,8,["class","modelValue"]),r(i,{name:"電話",class:"invalid-feedback"})]),e("div",me,[ue,r(t,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":_.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[3]||(s[3]=a=>l.form.user.address=a)},null,8,["class","modelValue"]),r(i,{name:"地址",class:"invalid-feedback"})]),e("div",pe,[_e,w(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[4]||(s[4]=a=>l.form.message=a)},null,512),[[k,l.form.message]])]),e("div",fe,[e("div",null,[r(h,{to:"/cart",class:"text-dark mt-6"},{default:V(()=>[be,L(" 回購物車 ")]),_:1})]),e("div",he,[e("button",{type:"submit",class:"btn btn-dark",disabled:l.isProcessing}," 送出訂單 ",8,ve)])])]),_:1},8,["onSubmit"])])}const $e=$(te,[["render",ge]]),Ve={data(){return{}},components:{OrderForm:$e,OrderDetail:Z},computed:{...y(U,["isLoading"])}},xe={class:"container py-5"},ye=S('<div class="row justify-content-center"><div class="col-lg-10"><nav aria-label="breadcrumb mb-5"><ol class="breadcrumb"><li class="breadcrumb-item text-gray">購物車</li><li class="breadcrumb-item text-dark active" aria-current="page"> 訂單資訊 </li><li class="breadcrumb-item text-gray">結帳</li></ol></nav></div></div>',1),we={class:"row flex-row-reverse justify-content-center py-4"};function ke(o,s,u,p,l,b){const t=n("VueLoading"),i=n("OrderDetail"),h=n("OrderForm");return c(),m("div",xe,[r(t,{active:o.isLoading,"onUpdate:active":s[0]||(s[0]=v=>o.isLoading=v)},null,8,["active"]),ye,e("div",we,[r(i),r(h)])])}const Ce=$(Ve,[["render",ke]]);export{Ce as default};
