import{c as g}from"./cartStore-136040f5.js";import{m as k,e as w,u as O,_ as $,o as c,c as m,a as e,F as P,n as C,t as d,j as y,v as T,r as n,b as r,w as V,p as f,d as E}from"./index-1d8dff61.js";import{T as x}from"./Toast-612bdcef.js";import{s as U}from"./statusStore-6a5fb02d.js";const D={data(){return{}},methods:{...k(g,["getCarts","addCouponCode"])},computed:{...w(g,["cart"]),...O(g,["coupon_code"])},mounted(){this.getCarts()}},S={class:"col-lg-4"},A={class:"border p-4 mb-4 bg-light"},I=["src","alt"],L={class:"w-100"},j={class:"d-flex justify-content-between"},F={class:"mb-0 fw-bold"},N={class:"mb-0"},q={class:"mb-0 fw-bold"},B={class:"table mt-4 border-top border-bottom text-muted"},H=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),M={class:"text-end border-0 px-0 pt-4"},R=e("tr",null,[e("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 付款方式 "),e("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),z={class:"input-group mb-3 input-group-sm"},W={class:"input-group-append"},G={class:"d-flex justify-content-between mt-4"},J=e("p",{class:"mb-0 h4 fw-bold"},"總計",-1),K={class:"mb-0 h4 fw-bold"};function Q(o,s,u,p,l,b){return c(),m("div",S,[e("div",A,[(c(!0),m(P,null,C(o.cart.carts,t=>(c(),m("div",{key:t.id,class:"d-flex mb-2"},[e("img",{src:t.product.imageUrl,alt:t.product.title,class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,I),e("div",L,[e("div",j,[e("p",F,d(t.product.title),1),e("p",N,"NT$ "+d(t.product.price),1)]),e("p",q,"x "+d(t.qty),1)])]))),128)),e("table",B,[e("tbody",null,[e("tr",null,[H,e("td",M,"NT$"+d(o.cart.total),1)]),R])]),e("div",z,[y(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=t=>o.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[T,o.coupon_code]]),e("div",W,[e("button",{class:"btn btn-outline-primary",type:"button",onClick:s[1]||(s[1]=t=>o.addCouponCode(o.coupon_code))}," 套用優惠碼 ")])]),e("div",G,[J,e("p",K,"NT$"+d(o.cart.final_total),1)])])])}const X=$(D,[["render",Q]]),{VITE_API:Y,VITE_PATH:Z}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"coffee11",BASE_URL:"/11th_street_cafe/",MODE:"production",DEV:!1,PROD:!0},ee={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""},isProcessing:!1}},methods:{createOrder(){this.isProcessing=!0;const o=this.form;this.$http.post(`${Y}/api/${Z}/order`,{data:o}).then(s=>{const{message:u,orderId:p}=s.data;this.isProcessing=!1,this.$refs.form.resetForm(),x.fire({title:`${u}`,icon:"success"}),this.$router.push(`/checkout/${p}`)}).catch(()=>{this.isProcessing=!1,x.fire({title:"無法新增資料，稍後再試",icon:"error"})})}}},se={class:"col-lg-6"},te=e("h3",{class:"mb-3"},"客戶資訊",-1),oe={class:"mb-3"},le=e("label",{for:"email",class:"form-label"},"Email",-1),re={class:"mb-3"},ae=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ne={class:"mb-3"},ie=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),de={class:"mb-3"},ce=e("label",{for:"address",class:"form-label"},"收件人地址",-1),me={class:"mb-3"},ue=e("label",{for:"message",class:"form-label"},"留言",-1),pe={class:"d-flex mt-4 justify-content-between align-items-md-center align-items-end w-100"},_e=e("i",{class:"fas fa-chevron-left me-2"},null,-1),fe={class:"text-end"},be=["disabled"];function he(o,s,u,p,l,b){const t=n("v-field"),i=n("error-message"),h=n("router-link"),v=n("v-form");return c(),m("div",se,[te,r(v,{ref:"form",onSubmit:b.createOrder},{default:V(({errors:_})=>[e("div",oe,[le,r(t,{id:"email",name:"email",type:"email",class:f(["form-control",{"is-invalid":_.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[0]||(s[0]=a=>l.form.user.email=a)},null,8,["class","modelValue"]),r(i,{name:"email",class:"invalid-feedback"})]),e("div",re,[ae,r(t,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":_.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[1]||(s[1]=a=>l.form.user.name=a)},null,8,["class","modelValue"]),r(i,{name:"姓名",class:"invalid-feedback"})]),e("div",ne,[ie,r(t,{id:"tel",name:"電話",type:"tel",class:f(["form-control",{"is-invalid":_.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10|numeric",modelValue:l.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=a=>l.form.user.tel=a)},null,8,["class","modelValue"]),r(i,{name:"電話",class:"invalid-feedback"})]),e("div",de,[ce,r(t,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":_.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[3]||(s[3]=a=>l.form.user.address=a)},null,8,["class","modelValue"]),r(i,{name:"地址",class:"invalid-feedback"})]),e("div",me,[ue,y(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[4]||(s[4]=a=>l.form.message=a)},null,512),[[T,l.form.message]])]),e("div",pe,[e("div",null,[r(h,{to:"/cart",class:"text-dark mt-6"},{default:V(()=>[_e,E("回購物車")]),_:1})]),e("div",fe,[e("button",{type:"submit",class:"btn btn-primary",disabled:l.isProcessing}," 送出訂單 ",8,be)])])]),_:1},8,["onSubmit"])])}const ve=$(ee,[["render",he]]),ge={data(){return{}},components:{OrderForm:ve,OrderDetail:X},computed:{...w(U,["isLoading"])}},$e={class:"container my-12"},Ve={class:"row flex-row-reverse justify-content-center py-7"};function xe(o,s,u,p,l,b){const t=n("VueLoading"),i=n("OrderDetail"),h=n("OrderForm");return c(),m("div",$e,[r(t,{active:o.isLoading,"onUpdate:active":s[0]||(s[0]=v=>o.isLoading=v)},null,8,["active"]),e("div",Ve,[r(i),r(h)])])}const Oe=$(ge,[["render",xe]]);export{Oe as default};
